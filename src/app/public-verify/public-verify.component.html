<div class="verify-container">

  <!-- Header -->
  <div class="header">
    <h1>Verify Evidence Chain</h1>
    <p>Drop a JSON file exported from Obrioxia to check integrity.</p>
  </div>

  <!-- Drop Zone -->
  <div 
    class="drop-zone"
    [class.dragging]="isDragging()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
  >
    <p *ngIf="!fileName()">Drop JSON file here or click to select</p>
    <p *ngIf="fileName()">File: {{ fileName() }}</p>
    <input type="file" accept=".json" (change)="onFileSelected($event)">
  </div>

  <!-- Status -->
  <div *ngIf="isProcessing()" class="loading">
    Processing file...
  </div>

  <!-- Result Section -->
  <div *ngIf="verificationResult()" [class]="resultClass">

    <!-- VALID RESULT -->
    <div *ngIf="verificationResult()?.valid">
      <h2 class="valid-title">INTEGRITY VERIFIED</h2>
      <p class="valid-sub">All {{ verificationResult()?.count }} blocks are valid and untampered.</p>
    </div>

    <!-- INVALID RESULT -->
    <div *ngIf="!verificationResult()?.valid && !verificationResult()?.isEmpty">
      <h2 class="invalid-title">CHAIN BROKEN</h2>
      <p class="invalid-sub">{{ verificationResult()?.error }}</p>
    </div>

    <!-- EMPTY FILE -->
    <div *ngIf="verificationResult()?.isEmpty">
      <h2 class="invalid-title">INVALID FILE</h2>
      <p class="invalid-sub">{{ verificationResult()?.error }}</p>
    </div>

  </div>

  <!-- Chain Preview -->
  <div class="chain-preview" *ngIf="chainData().length > 0">
    <h3>Chain Preview</h3>

    <div class="chain-item" *ngFor="let block of chainData()">

      <div class="seq">#{{ block.sequence }}</div>

      <div class="details">
        <div class="type">{{ block.event_type }}</div>
        <div class="actor">{{ block.actor_id }}</div>
        <div class="time">{{ block.timestamp | date:'medium' }}</div>

        <div class="hash-block">
          <span class="label">Chain Hash:</span>
          <span class="hash" [title]="block.chain_hash">
            {{ block.chain_hash | slice:0:12 }}...
          </span>
        </div>

        <div class="hash-block">
          <span class="label">Prev Hash:</span>
          <span class="hash" [title]="block.prev_chain_hash">
            {{ block.prev_chain_hash | slice:0:12 }}...
          </span>
        </div>
      </div>

    </div>
  </div>

</div>